<!DOCTYPE html>
<html lang="en">

<head>
    <title>ChestCov19</title>
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2781/2781395.png">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/style.css') }}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>

<body onload="getNews()">

    <header class="sticky">
        <nav>
            <label class="logos">ChestCov</label>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a class="active" href="/info">Covid News</a></li>
                <li><a href="/about">About Us</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
            <label id="icon">
                <img src="static/burger_menu.png" />
            </label>
        </nav>
        <script>
            $(document).ready(function () {
                $('#icon').click(function () {
                    $('ul').toggleClass('show');
                });
            });
        </script>
    </header>

    <!-- untuk di isi nanti -->

    <div class="text-center portfolio1">
        <h1 class="section-headtext-uppercase" style="font-family: sans-serif;">Perkembangan Covid Di Indonesia<br><br></h2>
    </div>

    <div class="row">
        <div class="column">
            <div class="card-konfirm">
                <h1 id="totalcase">Loading...</h1>
                <h2>Terkonfirmasi</h2>
            </div>
        </div>
        <div class="column">
            <div class="card-death">
                <h1 id="death">Loading...</h1>
                <h2>Meninggal</h2>
            </div>
        </div>
        <div class="column">
            <div class="card-recover">
                <h1 id="recover">Loading...</h1>
                <h2>Sembuh</h2>
            </div>
        </div>
        <div class="column">
            <div class="card-lastupdate">
                <h1 id="lastupdate">Loading...</h1>
                <h2>Terupdate</h2>
            </div>
        </div>
    </div>


    <script>
        fetch('https://covid19.mathdro.id/api/countries/indonesia')
            .then(res => res.json())
            .then(data => document.getElementById("totalcase").innerHTML = data.confirmed.value.toString().replace(
                /\B(?=(\d{3})+(?!\d))/g, ","));

        fetch('https://covid19.mathdro.id/api/countries/indonesia')
            .then(res => res.json())
            .then(data => document.getElementById("death").innerHTML = data.deaths.value.toString().replace(
                /\B(?=(\d{3})+(?!\d))/g, ","));

        fetch('https://covid19.mathdro.id/api/countries/indonesia')
            .then(res => res.json())
            .then(data => document.getElementById("recover").innerHTML = data.recovered.value.toString().replace(
                /\B(?=(\d{3})+(?!\d))/g, ","));

        fetch('https://covid19.mathdro.id/api/countries/indonesia')
            .then(res => res.json())
            .then(data => document.getElementById("lastupdate").innerHTML = new Date(data.lastUpdate)
                .toLocaleDateString('pt-PT'));
    </script>

    <div class="text-center portfolio1">
        <h1 class="section-headtext-uppercase" style="font-family: sans-serif;">Berita Terbaru Dari Cnbc<br><br></h2>
    </div>

    <section class="page-section" id="portfolio" style="margin-top: 20px;">
        <div class="container p-4" style="margin-top: 10px;">
            <div class="text-center portfolio1">
            </div>
            <div class="row" id="row-news"></div>
        </div>
    </section>
    <script>
        function getNews() {
            const rowNews = document.getElementById('row-news');
            let url = `https://csd027newsapi.herokuapp.com/cnbc/terbaru/`

            fetch(url).then((res) => {
                return res.json()
            }).then((data) => {
                console.log(data)
                data.data.posts.forEach(posts => {
                    console.log("ini data for each");
                    const image = posts.thumbnail.toLowerCase()

                    document.getElementById("row-news").innerHTML += ` <div class="col-lg-4 col-sm-6 mb-4">
                    <div class="portfolio-item">
                        <a class="portfolio-link" data-toggle="modal" href="${posts.link}" target="_blank" rel="noopener noreferrer">
                            <div class="portfolio-hover">
                                <div class="portfolio-hover-content"><i class="fa fa-plus fa-3x"></i></div>
                            </div>
                            <img class="img-fluid"
                                src="${posts.thumbnail.toLowerCase()}"
                                alt="news image" />
                        </a>
                        <div class="portfolio-caption">
                            <div class="portfolio-caption-heading">${posts.title}</div>
                            <div class="portfolio-caption-subheading text-muted">${new Date(posts.pubDate).toLocaleDateString('pt-PT')}
                        </div>
                        </div>
                    </div>
                </div>`
                    // console.log(posts.description)
                    //   let rowNews = document.createElement('li');
                    //   let a = document.createElement
                });
            })
        }
    </script>


</body>

<footer>
    <span>
        <center>CSD-027 &copy 2021 </center>
    </span>
</footer>

</html>